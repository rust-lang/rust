// Check that never patterns can't have bodies or guards.
//@ run-rustfix
#![feature(never_patterns)]
#![allow(incomplete_features, unreachable_patterns, unused_variables, dead_code)]

enum Void {}

fn main() {}

macro_rules! never {
    () => { ! }
}

fn no_arms_or_guards(x: Void) {
    match &None::<Void> {
        Some(!),
        //~^ ERROR a never pattern is always unreachable
        None => {}
    }
    match &None::<Void> { //~ ERROR: `&Some(!)` not covered
        Some(!),
        //~^ ERROR guard on a never pattern
        None => {}
        &Some(!)
    }
    match &None::<Void> { //~ ERROR: `&Some(!)` not covered
        Some(!),
        //~^ ERROR a never pattern is always unreachable
        None => {}
        &Some(!)
    }
    match &None::<Void> {
        Some(never!()),
        //~^ ERROR a never pattern is always unreachable
        None => {}
    }
}
