error: `extern` callback uses type `(i32, i32)`, which is not FFI-safe
  --> $DIR/allow-improper-ctypes.rs:38:34
   |
LL | type UnsafeFnPtr = extern "C" fn((i32, i32))->i32;
   |                                  ^^^^^^^^^^ not FFI-safe
   |
   = help: consider using a struct instead
   = note: tuples have unspecified layout
note: the lint level is defined here
  --> $DIR/allow-improper-ctypes.rs:1:9
   |
LL | #![deny(improper_ctypes, improper_ctypes_definitions)]
   |         ^^^^^^^^^^^^^^^

error: `extern` fn uses type `&str`, which is not FFI-safe
  --> $DIR/allow-improper-ctypes.rs:74:35
   |
LL | extern "C" fn fn1u(e: &String) -> &str {&*e}
   |                                   ^^^^ not FFI-safe
   |
   = help: consider using `*const u8` and a length instead
   = note: this reference to an unsized type contains metadata, which makes it incompatible with a C pointer
note: the lint level is defined here
  --> $DIR/allow-improper-ctypes.rs:1:26
   |
LL | #![deny(improper_ctypes, improper_ctypes_definitions)]
   |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^

error: `extern` fn uses type `UnsafeStruct`, which is not FFI-safe
  --> $DIR/allow-improper-ctypes.rs:80:23
   |
LL | extern "C" fn fn2u(e: UnsafeStruct) {}
   |                       ^^^^^^^^^^^^ not FFI-safe
   |
   = note: this struct/enum/union (`UnsafeStruct`) is FFI-unsafe due to a `String` field
note: the type is defined here
  --> $DIR/allow-improper-ctypes.rs:17:1
   |
LL | struct UnsafeStruct (String);
   | ^^^^^^^^^^^^^^^^^^^
   = help: consider adding a `#[repr(C)]` (not `#[repr(C,packed)]`) or `#[repr(transparent)]` attribute to `String`
   = note: `String` has unspecified layout

error: `extern` fn uses type `ext_crate::UnsafeStruct`, which is not FFI-safe
  --> $DIR/allow-improper-ctypes.rs:84:24
   |
LL | extern "C" fn fn2ou(e: ext_crate::UnsafeStruct) {}
   |                        ^^^^^^^^^^^^^^^^^^^^^^^ not FFI-safe
   |
   = note: this struct/enum/union (`ext_crate::UnsafeStruct`) is FFI-unsafe due to a `String` field
   = help: consider adding a `#[repr(C)]` (not `#[repr(C,packed)]`) or `#[repr(transparent)]` attribute to `String`
   = note: `String` has unspecified layout

error: `extern` fn uses type `AllowedUnsafeStruct`, which is not FFI-safe
  --> $DIR/allow-improper-ctypes.rs:89:23
   |
LL | extern "C" fn fn3u(e: AllowedUnsafeStruct) {}
   |                       ^^^^^^^^^^^^^^^^^^^ not FFI-safe
   |
   = note: this struct/enum/union (`AllowedUnsafeStruct`) is FFI-unsafe due to a `String` field
note: the type is defined here
  --> $DIR/allow-improper-ctypes.rs:21:1
   |
LL | struct AllowedUnsafeStruct (String);
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^
   = help: consider adding a `#[repr(C)]` (not `#[repr(C,packed)]`) or `#[repr(transparent)]` attribute to `String`
   = note: `String` has unspecified layout

error: `extern` fn uses type `ext_crate::AllowedUnsafeStruct`, which is not FFI-safe
  --> $DIR/allow-improper-ctypes.rs:94:24
   |
LL | extern "C" fn fn3ou(e: ext_crate::AllowedUnsafeStruct) {}
   |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ not FFI-safe
   |
   = note: this struct/enum/union (`ext_crate::AllowedUnsafeStruct`) is FFI-unsafe due to a `String` field
   = help: consider adding a `#[repr(C)]` (not `#[repr(C,packed)]`) or `#[repr(transparent)]` attribute to `String`
   = note: `String` has unspecified layout

error: `extern` callback uses type `&[A]`, which is not FFI-safe
  --> $DIR/allow-improper-ctypes.rs:138:28
   |
LL |     combine: extern "C" fn(&[A]) -> A,
   |                            ^^^^ not FFI-safe
   |
   = help: consider using a raw pointer to the slice's first element (and a length) instead
   = note: this reference to an unsized type contains metadata, which makes it incompatible with a C pointer

error: `extern` callback uses type `FakeVTable<u32>`, which is not FFI-safe
  --> $DIR/allow-improper-ctypes.rs:144:43
   |
LL | type FakeVTableMaker = extern "C" fn() -> FakeVTable<u32>;
   |                                           ^^^^^^^^^^^^^^^ not FFI-safe
   |
   = note: this struct/enum/union (`FakeVTable<u32>`) is FFI-unsafe due to a `(u32, usize)` field
note: the type is defined here
  --> $DIR/allow-improper-ctypes.rs:136:1
   |
LL | struct FakeVTable<A>{
   | ^^^^^^^^^^^^^^^^^^^^
   = help: consider using a struct instead
   = note: tuples have unspecified layout

error: aborting due to 8 previous errors

