error: the evaluated program deadlocked
  --> RUSTLIB/std/src/sys/thread/PLATFORM.rs:LL:CC
   |
LL |         let rc = unsafe { c::WaitForSingleObject(self.handle.as_raw_handle(), c::INFINITE) };
   |                                                                                          ^ thread got stuck here
   |
   = note: this is on thread `main`, inside `std::sys::thread::PLATFORM::Thread::join`
   = note: which got called inside `std::thread::lifecycle::JoinInner::<'_, ()>::join` (at RUSTLIB/std/src/thread/lifecycle.rs:LL:CC)
   = note: which got called inside `std::thread::JoinHandle::<()>::join` (at RUSTLIB/std/src/thread/join_handle.rs:LL:CC)
note: which got called inside `main`
  --> tests/fail-dep/concurrency/windows_join_main.rs:LL:CC
   |
LL | /     thread::spawn(|| {
LL | |         unsafe {
LL | |             assert_eq!(WaitForSingleObject(MAIN_THREAD, INFINITE), WAIT_OBJECT_0);
...  |
LL | |     .join()
   | |___________^

error: the evaluated program deadlocked
  --> tests/fail-dep/concurrency/windows_join_main.rs:LL:CC
   |
LL |             assert_eq!(WaitForSingleObject(MAIN_THREAD, INFINITE), WAIT_OBJECT_0);
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ thread got stuck here
   |
   = note: this is on thread `unnamed-ID`, inside closure
note: which got called indirectly due to this code
  --> tests/fail-dep/concurrency/windows_join_main.rs:LL:CC
   |
LL | /     thread::spawn(|| {
LL | |         unsafe {
LL | |             assert_eq!(WaitForSingleObject(MAIN_THREAD, INFINITE), WAIT_OBJECT_0);
LL | |         }
LL | |     })
   | |______^
   = note: this error originates in the macro `assert_eq` (in Nightly builds, run with -Z macro-backtrace for more info)

note: some details are omitted, run with `MIRIFLAGS=-Zmiri-backtrace=full` for a verbose backtrace

error: aborting due to 2 previous errors

